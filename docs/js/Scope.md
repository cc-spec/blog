---
title: 作用域
author: cc
date: '2021-12-21'
---

# 开始之前
## 1. 程序的执行过程？
- **分词/词法分析**：将代码切割成一块一块的词法单元，比如：var a = 2就会被切割成 var、a、=、2
- **解析/语法生成**：将词法单元转换成AST（机器指令），也就是抽象语法树
- **代码生成**：把AST转换为可执行代码
## 2. 谁来做这些事？
- **引擎**：负责代码的编译和执行
- **编译器**：负责语法分析和代码生成
- **作用域**：负责收集和维护标识符（变量、函数等）的查询规则

# 一、作用域
## 1. 什么是作用域？
- 一套确定在何处以及如何查找变量的规则
	- 以=为界，左边为容器，右边为值
	- **LHS**：根据值找容器，如变量赋值
  - **RHS**：根据容器找值，如调用函数，使用变量
## 2. 什么是词法作用域？
- 定义在词法阶段的作用域
## 3. 什么是作用域链？
- 查询变量会首先在自己的作用域中查找，如果没有查找到，回再向上一级查找，查找过程形成的链条就是作用域链

# 二、作用域引发的异常
## 1. ReferenceError
- 解释：引用错误
- 原因：
  - ①RHS在整条作用域链中没有查找到这个变量的值
  - ②LHS在整条作用域链中没有查找到目标变量，严格状态下会抛出ReferenceError，非严格状态会自动创建一个变量
## 2. TypeError
- 解释：类型错误
- 原因：RHS查询到了，但是企图对这个变量进行一些不允许的操作，比如引用undefined的属性
## 3. 两者区别
- ReferenceError：作用域判别失败
- TypeError：作用域判别成功，但是违规操作
